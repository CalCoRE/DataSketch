{"version":3,"sources":["modules/canvas/objects/group/model.coffee"],"names":[],"mappings":"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","file":"modules/canvas/objects/group/model.js","sourceRoot":"/source/","sourcesContent":["define (require) ->\n  BaseModel = require 'modules/canvas/objects/base/model'\n  Utils = require 'core/util/utils'\n\n  defaults =\n    children: []\n\n  class GroupModel extends BaseModel\n    constructor: (data) ->\n      super \n        data: data\n        defaults: defaults\n      @_normalize()\n\n    addChild: (child) =>\n      @_denormalize()\n      children = @get('children')\n      children.push child\n      @set 'children', children\n      @_normalize()\n\n    _denormalize: () =>\n      for child in @get('children')\n        child.x child.x() + @get('position.x')\n        child.y child.y() + @get('position.y')\n      @set 'position',\n        x: 0\n        y: 0\n\n    _normalize: () =>\n      cb = @_childBounds()\n      console.log cb\n\n      reference =\n        x: cb.left + (cb.right - cb.left) / 2\n        y: cb.top + (cb.bottom - cb.top) / 2\n      @set 'position', reference\n      for child in @get('children')\n        child.x child.x() - reference.x\n        child.y child.y() - reference.y\n\n    _childBounds: () =>\n      left = null\n      right = null\n      top = null\n      bottom = null\n      for child in @get('children')\n        bb = child.boundingBox()\n\n        left ?= bb.reference.x + bb.offset.x\n        right ?= bb.reference.x + bb.offset.x + bb.width\n        top ?= bb.reference.y + bb.offset.y\n        bottom ?= bb.reference.y + bb.offset.y + bb.height\n\n        left = Math.min left, bb.reference.x + bb.offset.x\n        right = Math.max right, bb.reference.x + bb.offset.x + bb.width\n        top = Math.min top, bb.reference.y + bb.offset.y\n        bottom = Math.max bottom, bb.reference.y + bb.offset.y + bb.height\n      bounds =\n        left: left\n        right: right\n        top: top\n        bottom: bottom\n\n    boundingBox: () =>\n      box = super()\n      cb = @_childBounds()\n      box.width = cb.right - cb.left\n      box.height = cb.bottom - cb.top\n      box.offset.x = -box.width / 2\n      box.offset.y = -box.height / 2\n      box"]}