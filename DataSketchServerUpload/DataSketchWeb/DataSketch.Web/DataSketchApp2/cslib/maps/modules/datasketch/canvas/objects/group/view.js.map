{"version":3,"file":"../../../../../../modules/datasketch/canvas/objects/group/view.js","sources":["modules/datasketch/canvas/objects/group/view.coffee"],"names":[],"mappings":"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","sourcesContent":["define (require) ->\r\n  CanvasObjectView = require 'modules/datasketch/canvas/objects/base/view'\r\n  Fabric = require 'thirdparty/fabric'\r\n\r\n  class GroupView extends CanvasObjectView\r\n    constructor: (model) ->\r\n      super model\r\n\r\n    buildFabric: (model) =>      \r\n      old = @_fabric\r\n      fabric = new Fabric.Group\r\n\r\n      fabric.originX = \"center\"\r\n      fabric.originY = \"center\"\r\n      center = null\r\n      dims =\r\n        left: null\r\n        right: null\r\n        top: null\r\n        bottom: null\r\n        stroke:null\r\n      for obj in model.get 'children'\r\n        v = obj.getFabric()\r\n        bb = v.getBoundingRect()\r\n        dims.left = if dims.left? then Math.min(bb.left, dims.left) else bb.left\r\n        dims.right = if dims.right? then Math.max(bb.left + bb.width, dims.right) else bb.left + bb.width\r\n        dims.top = if dims.top? then Math.min(bb.top, dims.top) else bb.top\r\n        dims.bottom = if dims.bottom? then Math.max(bb.top + bb.height, dims.bottom) else bb.top + bb.height\r\n        #dims.stroke = if dims.stroke? then bb.stroke\r\n        fabric.addWithUpdate v\r\n        v.remove() if v.canvas?\r\n      if !center?\r\n        center =\r\n          x: (dims.left + dims.right) / 2\r\n          y: (dims.top + dims.bottom) / 2\r\n      for obj in model.get 'children'\r\n        obj.getFabric().setCoords()\r\n      #window.currentId for checking new generated id of an object.            \r\n      if window.currentId > model.get('id')\r\n         id = window.currentId + 1         \r\n      else\r\n         id = model.get('id')\r\n\r\n      if window.currentId < id\r\n         window.currentId = id\r\n         model.set 'id', id   \r\n\r\n      if !fabric.newId && window.currentId < fabric.newId\r\n         window.currentId = fabric.newId  \r\n         model.set 'id', fabric.newId\r\n\r\n      if fabric.id != \"grid\" && !fabric.newId\r\n         fabric.set 'id', id\r\n      else\r\n         fabric.set 'id', fabric.newId\r\n\r\n      @setFabric fabric, model\r\n      @dispatchEvent \"CanvasObject.FabricGenerated\",\r\n        fabric: fabric\r\n        old_fabric: old\r\n"]}