{"version":3,"file":"../../../../modules/datasketch/menuitems/map.js","sources":["modules/datasketch/menuitems/map.coffee"],"names":[],"mappings":"AAAA;AAAA,MAAA;;;;;EAAA,MAAA,CAAO,SAAC,OAAD;AACL,QAAA;IAAA,MAAA,GAAS,OAAA,CAAQ,iBAAR;IACT,EAAA,GAAK,OAAA,CAAQ,yBAAR;IACL,OAAA,GAAU,OAAA,CAAQ,oBAAR;IAEV,uBAAA,GAA0B,OAAA,CAAQ,+CAAR;WAEpB;;;MACS,8BAAA;;;QACX,uDAAA,SAAA;MADW;;qCAGb,IAAA,GAAM,SAAA;eACJ,EAAE,CAAC,IAAH,CAAQ,0BAAR,EAAoC,IAAC,CAAA,cAArC;MADI;;qCAGN,cAAA,GAAgB,SAAC,IAAD,EAAO,IAAP;AACd,YAAA;QAAA,iDAAyB,CAAE,gBAAxB,KAAkC,CAArC;UACE,WAAA,GAAc,EAAE,CAAC,MAAH,CAAU,8BAAV,EAA0C,EAA1C;UACd,SAAA,GAAY,EAAE,CAAC,MAAH,CAAU,4BAAV,EAAwC,EAAxC;UACZ,KAAA,GAAQ;UACR,QAAA,GAAW,IAAI,CAAC,OAAO,CAAC,SAAU,CAAA,CAAA,CAAE,CAAC,mBAA1B,CAAA;UACX,WAAA;;AAAe;iBAAA,0CAAA;;2BAAA,CAAC,CAAC,cAAc,CAAC,KAAjB,CAAA;AAAA;;;AACf,eAAA,6CAAA;;YACE,QAAA,GAAW;YACX,WAAG,EAAE,CAAC,KAAH,CAAA,CAAA,EAAA,aAAc,WAAd,EAAA,IAAA,MAAH;cACE,EAAA,GAAK;AACL,mBAAA,4CAAA;;gBACE,IAAG,CAAC,CAAC,cAAc,CAAC,KAAjB,CAAA,CAAA,KAA4B,EAAE,CAAC,KAAH,CAAA,CAA/B;kBACE,EAAA,GAAK,CAAC,CAAC,aADT;;AADF,eAFF;aAAA,MAAA;AAME,mBAAA,6CAAA;;gBACE,QAAQ,CAAC,IAAT,CACE;kBAAA,EAAA,EAAM,CAAC,EAAE,CAAC,KAAH,CAAA,CAAD,CAAA,GAAY,GAAZ,GAAc,CAAC,EAAE,CAAC,KAAH,CAAA,CAAD,CAApB;kBACA,KAAA,EAAO,EAAE,CAAC,OAAH,CAAA,CADP;kBAEA,MAAA,EAAQ,IAAI,uBAAJ,CAA4B,IAAI,CAAC,OAAO,CAAC,SAAU,CAAA,CAAA,CAAnD,EAAuD,EAAvD,EAA2D,EAA3D,CAFR;iBADF;AADF,eANF;;YAYA,QAAA,GAAW;YACX,IAAG,CAAC,EAAE,CAAC,KAAH,CAAA,CAAA,KAAc,OAAd,IAA0B,CAAC,aAAY,WAAZ,EAAA,QAAA,MAAA,IAA2B,aAAW,WAAX,EAAA,OAAA,MAA5B,CAA3B,CAAA,IAAmF,CAAC,SAAA,EAAE,CAAC,KAAH,CAAA,EAAA,KAAe,QAAf,IAAA,IAAA,KAAyB,OAAzB,CAAA,IAAsC,aAAW,WAAX,EAAA,OAAA,MAAvC,CAAtF;cACE,QAAA,GAAW,KADb;;YAGA,IAAI,CAAC,IAAL,CACE;cAAA,EAAA,EAAI,EAAE,CAAC,KAAH,CAAA,CAAJ;cACA,KAAA,EAAO,EAAE,CAAC,OAAH,CAAA,CADP;cAEA,KAAA,EAAO,QAFP;aADF;AAlBF,WANF;;eA8BA;MA/Bc;;;;OAPiB;EAP9B,CAAP;AAAA","sourcesContent":["define (require) ->\n  Module = require 'core/app/module'\n  HM = require 'core/event/hook_manager'\n  Globals = require 'core/model/globals'\n\n  MappingAssignmentAction = require 'modules/datasketch/actions/mapping_assignment'\n\n  class DeleteMenuItemModule extends Module\n    constructor: () ->\n      super\n\n    init: () =>\n      HM.hook 'ObjectProperty.MenuItems', @_hookMenuItems\n\n    _hookMenuItems: (list, meta) =>      \n      if meta.context.selection?.length == 1\n        objectProps = HM.invoke 'DataMapping.ObjectProperties', []\n        dataProps = HM.invoke 'DataMapping.DataProperties', []\n        items = []\n        mappings = meta.context.selection[0].getPropertyMappings()\n        mappedProps = (m.objectProperty.getId() for m in mappings)\n        for op in objectProps\n          subitems = []\n          if op.getId() in mappedProps\n            dp = null\n            for m in mappings\n              if m.objectProperty.getId() == op.getId()\n                dp = m.dataProperty\n          else\n            for dp in dataProps\n              subitems.push\n                id: \"#{op.getId()}-#{dp.getId()}\"\n                label: dp.getName()\n                action: new MappingAssignmentAction meta.context.selection[0], op, dp\n\n          disabled = false\n          if (op.getId() == \"scale\" and (\"height\" in mappedProps or \"width\" in mappedProps)) or (op.getId() in [\"height\", \"width\"] and \"scale\" in mappedProps)\n            disabled = true\n\n          list.push\n            id: op.getId()\n            label: op.getName()\n            items: subitems\n            #disabled: disabled\n\n      list\n"]}