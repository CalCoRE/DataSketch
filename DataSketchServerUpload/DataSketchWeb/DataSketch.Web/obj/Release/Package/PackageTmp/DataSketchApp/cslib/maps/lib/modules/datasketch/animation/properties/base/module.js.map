{"version":3,"file":"../../../../../../../lib/modules/datasketch/animation/properties/base/module.js","sources":["lib/modules/datasketch/animation/properties/base/module.coffee"],"names":[],"mappings":"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","sourcesContent":["define (require) ->\r\n  Module = require 'core/app/module'\r\n  Model = require 'core/model/model'\r\n  HM = require 'core/event/hook_manager'\r\n  Globals = require 'core/model/globals'\r\n  Canvas =require 'modules/datasketch/canvas/canvas'\r\n\r\n  CalibrationForm = require './calibration/form'\r\n  Modal = require 'modules/modal/modal'\r\n  Animator = require '../../animator'  \r\n  MappingAssignmentAction = require 'modules/datasketch/actions/mapping_assignment' \r\n\r\n  class AnimationProperty extends Module\r\n    constructor: (settings) ->\r\n      super()\r\n      @_model = new Model\r\n        data: settings\r\n      HM.hook 'DataMapping.ObjectProperties', @_hookObjectProperties      \r\n\r\n    getId: () =>\r\n      @_model.get 'id'\r\n\r\n    getName: () =>\r\n      @_model.get 'name'\r\n\r\n    _hookObjectProperties: (list, meta) =>\r\n      list.push @\r\n      list\r\n\r\n    calibrate: () =>\r\n      new Promise (resolve, reject) =>        \r\n        form = @getCalibrationForm()\r\n        \r\n        Modal._view.addEventListener 'Form.Modal.CloseRequest', () =>\r\n          ##this.removeTempPlayAnimation this\r\n            \r\n        ###\r\n        form.addEventListener 'Form.SelectColor', () =>\r\n          resolve form.value()  \r\n          this.tempPlayAnimation()\r\n        ###\r\n\r\n        form.addEventListener 'Form.Submit', () =>\r\n          debugger\r\n          canvas = new Canvas\r\n          canvas.ModalClose()\r\n          Modal.close()\r\n          resolve form.value()\r\n\r\n        form.addEventListener 'Form.Cancel', () =>\r\n          canvas = new Canvas\r\n          canvas.ModalClose()\r\n          Modal.close()\r\n          ##this.removeTempPlayAnimation this\r\n          e = new Error \"Calibration canceled\"\r\n          e.name = \"FormCanceledError\"\r\n          reject e\r\n        Modal.display form        \r\n        \r\n        ###\r\n        #Event got triggered on change of max field        \r\n        $('#max').change () =>          \r\n          resolve form.value()\r\n          #Set the min max value for animation in to model.          \r\n          @_model.set 'max', form.value().max\r\n          @_model.set 'min', form.value().min\r\n          this.tempPlayAnimation()\r\n        \r\n        #Event got triggered on change of min field\r\n        $('#min').change () =>          \r\n          resolve form.value()\r\n          #Set the min max value for animation in to model.\r\n          @_model.set 'max', form.value().max\r\n          @_model.set 'min', form.value().min\r\n          this.tempPlayAnimation()\r\n        ###\r\n        \r\n    getCalibrationForm: () =>\r\n      canvas = new Canvas\r\n      canvas.ModalOpen()\r\n      new CalibrationForm\r\n\r\n    setPropertyValue: (object, calibration, percent) =>      \r\n\r\n    #Method for playing animation on object for single time on change of an input field.\r\n    tempPlayAnimation: () =>\r\n        @_animator = new Animator\r\n            canvas: Globals.get 'Canvas'\r\n            datastore: Globals.get 'DataStore'\r\n          @_animator.cache()\r\n          @_animator._isLoop = false\r\n          @_animator.reset()\r\n          @_animator.restore()\r\n          @_animator.play()\r\n\r\n    #Remove the animation property mapping from an object.\r\n    removeTempPlayAnimation: (_this) =>\r\n        ##Remove last animation from object  \r\n        object = _this._animator.settings.canvas.getSelectedObjects()\r\n        objectProperty = _this                    \r\n        object[0].removePropertyMapping objectProperty"]}