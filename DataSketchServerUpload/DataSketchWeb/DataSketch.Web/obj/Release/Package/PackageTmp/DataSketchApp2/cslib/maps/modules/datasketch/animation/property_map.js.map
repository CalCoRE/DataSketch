{"version":3,"file":"../../../../modules/datasketch/animation/property_map.js","sources":["modules/datasketch/animation/property_map.coffee"],"names":[],"mappings":"AAAA;AAAA,MAAA;;EAAA,MAAA,CAAO,SAAC,OAAD;AACL,QAAA;IAAA,OAAA,GAAU,OAAA,CAAQ,oBAAR;WACJ;AACJ,UAAA;;MAAA,IAAA,wDAAO,UAAU;;MACJ,qBAAC,QAAD;;QACX,IAAC,CAAA,cAAD,GAAkB,QAAQ,CAAC;QAC3B,IAAC,CAAA,YAAD,GAAgB,QAAQ,CAAC;QACzB,IAAC,CAAA,WAAD,GAAe,QAAQ,CAAC;MAHb;;4BAKb,YAAA,GAAc,SAAC,MAAD,EAAS,QAAT,EAAmB,SAAnB,EAA8B,SAA9B;AACZ,YAAA;QAAA,OAAA,GAAU,IAAI,CAAC,KAAL,CAAW,CAAC,QAAA,GAAW,IAAZ,CAAA,GAAoB,MAAM,CAAC,gBAAgB,CAAC,UAAvD;QACV,OAAA,GAAU,OAAA,GAAU;QACpB,MAAM,CAAC,UAAP,GAAoB,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;QACzC,MAAM,CAAC,YAAP,GAAsB,SAAS,CAAC,GAAV,CAAc,MAAd,CAAqB,CAAC;QAG5C,IAAG,SAAS,CAAC,GAAV,CAAc,MAAd,CAAqB,CAAC,MAAtB,GAA+B,OAAlC;UACE,GAAA,GAAM,CAAC,QAAA,GAAW,IAAZ,CAAA,GAAoB,MAAM,CAAC,gBAAgB,CAAC,UAA5C,GAAyD;UAC/D,OAAA,GAAU,SAAS,CAAC,GAAV,CAAc,MAAd,CAAsB,CAAA,OAAA;UAChC,OAAA,GAAU,SAAS,CAAC,GAAV,CAAc,MAAd,CAAsB,CAAA,OAAA;UAKhC,IAAG,SAAS,CAAC,GAAV,CAAc,MAAd,CAAsB,CAAA,OAAA,CAAQ,CAAC,QAA/B,CAAwC,IAAC,CAAA,YAAY,CAAC,KAAd,CAAA,CAAxC,CAAA,KAAkE,EAAlE,IAAwE,SAAS,CAAC,GAAV,CAAc,MAAd,CAAsB,CAAA,OAAA,CAAQ,CAAC,QAA/B,CAAwC,IAAC,CAAA,YAAY,CAAC,KAAd,CAAA,CAAxC,CAAA,KAAkE,EAA7I;YAEI,GAAA,GAAM,IAAA,CAAK,SAAS,CAAC,GAAV,CAAc,MAAd,CAAsB,CAAA,OAAA,CAAQ,CAAC,QAA/B,CAAwC,IAAC,CAAA,YAAY,CAAC,KAAd,CAAA,CAAxC,CAAL,CAAA,GAAuE,IAAA,CAAK,SAAS,CAAC,GAAV,CAAc,MAAd,CAAsB,CAAA,OAAA,CAAQ,CAAC,QAA/B,CAAwC,IAAC,CAAA,YAAY,CAAC,KAAd,CAAA,CAAxC,CAAA,GAAiE,SAAS,CAAC,GAAV,CAAc,MAAd,CAAsB,CAAA,OAAA,CAAQ,CAAC,QAA/B,CAAwC,IAAC,CAAA,YAAY,CAAC,KAAd,CAAA,CAAxC,CAAtE,CAAA,GAAwI,IAAA,CAAK,GAAL;YAErN,MAAA,GAAS,SAAS,CAAC,SAAV,CAAoB,IAAC,CAAA,YAArB;YAIT,OAAA,GAAU,IAAA,CAAK,GAAA,GAAM,MAAM,CAAC,GAAlB,CAAA,GAAyB,IAAA,CAAK,MAAM,CAAC,GAAP,GAAa,MAAM,CAAC,GAAzB;YAEnC,IAAC,CAAA,OAAD,GAAW,OAAO,CAAC,GAAR,CAAY,QAAZ;YACX,IAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,UAApB,KAAkC,IAArC;cACI,MAAA,GAAS;cACT,KAAA,GAAQ,MAAM,CAAC,KAAP,CAAA;cAER,IAAG,MAAO,CAAA,KAAA,GAAM,aAAN,CAAP,KAA+B,IAA/B,IAAuC,MAAO,CAAA,KAAA,GAAM,aAAN,CAAP,KAA+B,MAAzE;gBACE,MAAO,CAAA,KAAA,GAAM,aAAN,CAAP,GAA8B;gBAC9B,MAAO,CAAA,KAAA,GAAM,aAAN,CAAP,GAA8B,CAAC,EAFjC;;cAIA,IAAG,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAArB,KAA6B,MAA7B,IAAuC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAArB,KAA6B,OAAvE;gBACE,IAAG,MAAO,CAAA,KAAA,GAAM,aAAN,CAAP,KAA+B,OAAlC;kBACE,MAAA,GAAS,MAAM,CAAC,KAAP,CAAa,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAAlC;kBACT,MAAM,CAAC,OAAP,CAAA;kBACA,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,OAArB,GAA+B,IAAI,CAAC,GAAL,CAAS,CAAC,MAAM,CAAC,cAAP,GAAwB,GAAzB,CAAA,GAAgC,GAAzC,CAA6C,CAAC,OAA9C,CAAsD,CAAtD;kBAC/B,MAAM,CAAC,cAAP,IAAyB;kBACzB,MAAM,CAAC,cAAP,GAAwB,MAAM,CAAC,cAAP,GAAwB;kBAChD,IAAG,MAAM,CAAC,cAAP,KAAyB,CAA5B;oBACE,MAAM,CAAC,cAAP,GAAwB,KAD1B;;kBAEA,MAAO,CAAA,KAAA,GAAM,aAAN,CAAoB,CAAC,IAA5B,CAAiC,MAAjC;kBACA,IAAC,CAAA,OAAO,CAAC,kBAAT,CAA4B,MAA5B;kBACA,IAAG,OAAA,GAAU,MAAO,CAAA,KAAA,GAAM,aAAN,CAApB;oBACE,IAAG,MAAO,CAAA,KAAA,GAAM,aAAN,CAAoB,CAAC,MAA5B,GAAqC,CAAxC;sBACE,OAAO,CAAC,GAAR,CAAY,QAAZ,CAAqB,CAAC,aAAtB,CAAoC,MAAO,CAAA,KAAA,GAAM,aAAN,CAA3C,EADF;;oBAEA,MAAM,CAAC,cAAP,GAAwB,EAH1B;;kBAIA,MAAO,CAAA,KAAA,GAAM,aAAN,CAAP,GAA8B,QAdhC;iBADF;eAAA,MAAA;gBAiBE,IAAG,MAAO,CAAA,KAAA,GAAM,aAAN,CAAP,KAA+B,OAAlC;kBACC,MAAM,CAAC,KAAP,CAAa,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAAlC,CAAuC,CAAC,IAAxC,CAA6C,CAAA,SAAA,KAAA;2BAAA,SAAC,MAAD;AAC3C,0BAAA;sBAAA,MAAA,GAAS;sBACT,MAAM,CAAC,OAAP,CAAA;sBACA,IAAG,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAArB,KAA6B,OAAhC;AACE;AAAA,6BAAA,qCAAA;;0BACE,GAAG,CAAC,OAAJ,GAAc,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,OAArB,GAA+B,IAAI,CAAC,GAAL,CAAS,CAAC,MAAM,CAAC,cAAP,GAAwB,GAAzB,CAAA,GAAgC,GAAzC,CAA6C,CAAC,OAA9C,CAAsD,CAAtD;AAD/C,yBADF;uBAAA,MAAA;wBAIE,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,OAArB,GAA+B,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,OAArB,GAA+B,IAAI,CAAC,GAAL,CAAS,CAAC,MAAM,CAAC,cAAP,GAAwB,GAAzB,CAAA,GAAgC,GAAzC,CAA6C,CAAC,OAA9C,CAAsD,CAAtD,EAJhE;;sBAKA,MAAM,CAAC,cAAP,IAAyB;sBACzB,IAAG,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,OAArB,KAAgC,CAAnC;wBACE,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,OAArB,GAA+B,EADjC;;sBAEA,MAAO,CAAA,KAAA,GAAM,aAAN,CAAoB,CAAC,IAA5B,CAAiC,MAAjC;sBACA,KAAC,CAAA,OAAO,CAAC,kBAAT,CAA4B,MAA5B;sBACA,IAAG,OAAA,GAAU,MAAO,CAAA,KAAA,GAAM,aAAN,CAApB;wBACE,IAAG,MAAO,CAAA,KAAA,GAAM,aAAN,CAAoB,CAAC,MAA5B,GAAqC,CAAxC;0BACE,OAAO,CAAC,GAAR,CAAY,QAAZ,CAAqB,CAAC,aAAtB,CAAoC,MAAO,CAAA,KAAA,GAAM,aAAN,CAA3C,EADF;;wBAEA,MAAM,CAAC,cAAP,GAAwB,EAH1B;;6BAIA,MAAO,CAAA,KAAA,GAAM,aAAN,CAAP,GAA8B;oBAjBa;kBAAA,CAAA,CAAA,CAAA,IAAA,CAA7C,EADD;iBAjBF;eARJ;;mBA6CA,IAAC,CAAA,cAAc,CAAC,gBAAhB,CAAiC,MAAjC,EAAyC,IAAC,CAAA,WAA1C,EAAuD,OAAvD,EAxDJ;WARF;;MAPY;;;;;EATX,CAAP;AAAA","sourcesContent":["define (require) ->\r\n  Globals = require 'core/model/globals'\r\n  class PropertyMap\r\n    root = exports ? this\r\n    constructor: (settings) ->      \r\n      @objectProperty = settings.objectProperty\r\n      @dataProperty = settings.dataProperty\r\n      @calibration = settings.calibration\r\n      \r\n    applyMapping: (object, playhead, timeDelta, dataStore) =>\r\n      rowPrev = Math.floor (playhead / 1000) / window.DataSketchConfig.timePerRow      \r\n      rowNext = rowPrev + 1     \r\n      window.objectLeft = object._view._fabric.left\r\n      window.timeRequired = dataStore.get('rows').length\r\n      \r\n      \r\n      if dataStore.get('rows').length > rowNext\r\n        mid = (playhead / 1000) / window.DataSketchConfig.timePerRow - rowPrev\r\n        prevRow = dataStore.get('rows')[rowPrev]\r\n        nextRow = dataStore.get('rows')[rowNext]\r\n\r\n        #Make an comment because of unused variable.\r\n        #prevRowValue = prevRow.getValue(@dataProperty.getId())\r\n        #nextRowValue = nextRow.getValue(@dataProperty.getId())       \r\n        if(dataStore.get('rows')[rowPrev].getValue(@dataProperty.getId()) != \"\" || dataStore.get('rows')[rowNext].getValue(@dataProperty.getId()) != \"\")\r\n\r\n            val = eval(dataStore.get('rows')[rowPrev].getValue(@dataProperty.getId())) + eval(dataStore.get('rows')[rowNext].getValue(@dataProperty.getId()) - dataStore.get('rows')[rowPrev].getValue(@dataProperty.getId())) * eval(mid)\r\n\r\n            minMax = dataStore.getMinMax @dataProperty\r\n            #@objCalibration = {}  \r\n            #@objCalibration.max=@calibration.max;\r\n            #@objCalibration.min=window.objectLeft;\r\n            percent = eval(val - minMax.min) / eval(minMax.max - minMax.min)      \r\n\r\n            @_canvas = Globals.get('Canvas')\r\n            if object._model._data.isStamping == true\r\n                Trail1 = null\r\n                objId = object.getId()\r\n\r\n                if window[objId+\"arrayObject\"] == null || window[objId+\"arrayObject\"] == undefined\r\n                  window[objId+\"arrayObject\"] = []\r\n                  window[objId+\"previousRow\"] = -1\r\n\r\n                if object._view._fabric.type != \"path\" && object._view._fabric.type != \"group\"      \r\n                  if window[objId+\"previousRow\"] != rowNext\r\n                    Trail1 = object.clone(object._view._fabric.type)\r\n                    Trail1.disable()\r\n                    Trail1._view._fabric.opacity = Math.abs((window.opacityManager / 100) + 0.2).toFixed(2)                                \r\n                    window.opacityManager += 1\r\n                    window.opacityManager = window.opacityManager - 0.02\r\n                    if window.opacityManager == 0\r\n                      window.opacityManager = 0.30             \r\n                    window[objId+\"arrayObject\"].push Trail1                  \r\n                    @_canvas.addStampingObjects Trail1        \r\n                    if rowNext < window[objId+\"previousRow\"]\r\n                      if window[objId+\"arrayObject\"].length > 0\r\n                        Globals.get('Canvas').removeObjects window[objId+\"arrayObject\"]\r\n                      window.opacityManager = 1\r\n                    window[objId+\"previousRow\"] = rowNext\r\n                else\r\n                  if window[objId+\"previousRow\"] != rowNext\r\n                   object.clone(object._view._fabric.type).then (clones) =>\r\n                     Trail1 = clones\r\n                     Trail1.disable()\r\n                     if object._view._fabric.type == \"group\" \r\n                       for obj in Trail1._view._fabric._objects\r\n                         obj.opacity = Trail1._view._fabric.opacity = Math.abs((window.opacityManager / 100) + 0.2).toFixed(2)                \r\n                     else \r\n                       Trail1._view._fabric.opacity = Trail1._view._fabric.opacity = Math.abs((window.opacityManager / 100) + 0.2).toFixed(2)                \r\n                     window.opacityManager += 1\r\n                     if Trail1._view._fabric.opacity == 0\r\n                       Trail1._view._fabric.opacity = 1     \r\n                     window[objId+\"arrayObject\"].push Trail1\r\n                     @_canvas.addStampingObjects Trail1        \r\n                     if rowNext < window[objId+\"previousRow\"]\r\n                       if window[objId+\"arrayObject\"].length > 0\r\n                         Globals.get('Canvas').removeObjects window[objId+\"arrayObject\"]\r\n                       window.opacityManager = 1\r\n                     window[objId+\"previousRow\"] = rowNext\r\n            \r\n            @objectProperty.setPropertyValue object, @calibration, percent\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    \r\n    \r\n    \r\n       \r\n\r\n"]}