{"version":3,"file":"../../../../../modules/datasketch/tools/calibrationandmanipulation/tool.js","sources":["modules/datasketch/tools/calibrationandmanipulation/tool.coffee"],"names":[],"mappings":"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","sourcesContent":["define (require) ->\r\n  Tool = require 'modules/toolkit/tool/tool'\r\n  Globals = require 'core/model/globals'\r\n  HM  = require 'core/event/hook_manager'  \r\n  View = require './view'\r\n  require 'link!./style.css'\r\n\r\n  #Include action files for performing different operations.\r\n  MappingAssignmentAction = require 'modules/datasketch/actions/mapping_assignment'\r\n  ObjectManipulationAction = require 'modules/datasketch/actions/object_manipulation'\r\n  RemoveCalibrationAction = require 'modules/datasketch/actions/remove_calibration' \r\n  StampingEffect = require 'modules/datasketch/actions/stamping_effect' \r\n\r\n  class CalibrationAndManipulationTool extends Tool    \r\n    constructor: () ->\r\n      super                \r\n        viewClass: View      \r\n\r\n    generateAction: () =>\r\n      dataStore = Globals.get 'DataStore'\r\n      #Array for storing minimum and maximum value of calibration of selected property\r\n      minMaxofProperty=[]\r\n      \r\n      \r\n      #Condition for checking whether reset button of \"CalibrationAndManipulationModal\" modal is triggered or not.\r\n      if window.currentActionId == \"calibrationRemoveButton\"\r\n         $('#maxRangeInput, #minRangeInput').val(0)        \r\n         $('#maxInput, #minInput').html(0)                 \r\n         RemoveCalibrationAction removeCalibrationAction= new RemoveCalibrationAction Globals.get 'Canvas'\r\n         removeCalibrationAction.execute()\r\n         $('#colorProperty')[0].selectedIndex = 0\r\n\r\n      #Condition for checking whether Apply button of \"CalibrationAndManipulation\" modal is triggered or not.\r\n      if window.currentActionId == \"calibrationApplyButton\"\r\n         @_objectProperty = HM.invoke 'DataMapping.ObjectProperties', []\r\n         ObjectProperty = @_objectProperty.filter((data)=>return data.getId() == $('.activeMenu')[0].id)\r\n         $('#CalibrationAndManipulationModal').modal('hide')\r\n         canvas = Globals.get 'Canvas'\r\n         animationDataProperty = []\r\n         CsvProperty = Globals.get 'DataStore'\r\n         objectDataProperty = null\r\n         if window.objectPropertyId == \"color\"\r\n           objectDataProperty = $('#csvPropertyColor').val()\r\n           window.objectPropertyMinimum = $('#colorProperty').val().split('-')[0]\r\n           window.objectPropertyMaximum = $('#colorProperty').val().split('-')[1]\r\n         else if window.objectPropertyId == \"stamping\"\r\n           StampingEffect stampingEffect = new StampingEffect canvas,canvas._model._data.selected[0],$('#isStamp')[0].checked\r\n           stampingEffect.execute()\r\n         else\r\n           objectDataProperty = $('#csvProperty').val()\r\n           window.objectPropertyMinimum = $('#minRangeInput').val()\r\n           window.objectPropertyMaximum = $('#maxRangeInput').val()\r\n         if window.objectPropertyId != \"stamping\"\r\n             for obj in CsvProperty._data.properties\r\n               if obj._data.id == objectDataProperty\r\n                  animationDataProperty = obj        \r\n             MappingAssignmentAction mappingAssignmentAction = new MappingAssignmentAction canvas._model._data.selected[0],ObjectProperty[0],animationDataProperty\r\n             mappingAssignmentAction.execute()\r\n              \r\n      #Event got triggered on closing of \"CalibrationAndManipulationModal\" modal.\r\n      $('#CalibrationAndManipulationModal').on 'hidden.bs.modal',(e) =>        \r\n        $('#shape')[0].style.pointerEvents = 'auto'\r\n        $('#isStamp')[0].checked = false\r\n        $('.objectproperty-menu .menu-item').removeClass('activeMenu')\r\n        $(\"input[name=minMaxValue][value='minValue']\").prop(\"checked\",true);\r\n        $('#colorProperty').val(\"#f7f7f7-#252525\")\r\n        Globals.get('Canvas').applyOriginalProperty()\r\n        $(this).off('hide.bs.modal');                       \r\n        e.stopImmediatePropagation()\r\n\r\n      for obj in dataStore._data.properties\r\n          if obj._data.id == $('#csvProperty').val()\r\n              minMaxofProperty = obj\r\n      \r\n      if $('#csvProperty').val()\r\n         minMax = dataStore.getMinMax minMaxofProperty         \r\n         $('#propertyMaxValue').html(minMax.max)\r\n         $('#propertyMinValue').html(minMax.min)\r\n      \r\n      #Condition for checking whether input sliders value got changed.\r\n      if window.currentActionId == \"minRangeInput\"\r\n         if window.objectPropertyId == \"width\" || window.objectPropertyId == \"height\" || window.objectPropertyId == \"scale\"\r\n           $('#minInput').html(eval($('#minRangeInput').val()).toFixed(1))\r\n         else\r\n           $('#minInput').html(eval($('#minRangeInput').val()))\r\n         ObjectManipulationAction objectManipulationAction = new ObjectManipulationAction Globals.get 'Canvas'\r\n         objectManipulationAction.execute()\r\n         $(\"input[name=minMaxValue][value='minValue']\").prop(\"checked\",true)\r\n      else if window.currentActionId == \"maxRangeInput\"\r\n         if window.objectPropertyId == \"width\" || window.objectPropertyId == \"height\" || window.objectPropertyId == \"scale\"\r\n            $('#maxInput').html(eval($('#maxRangeInput').val()).toFixed(1))\r\n         else\r\n           $('#maxInput').html(eval($('#maxRangeInput').val()))\r\n         ObjectManipulationAction objectManipulationAction = new ObjectManipulationAction Globals.get 'Canvas'\r\n         objectManipulationAction.execute()\r\n         $(\"input[name=minMaxValue][value='maxValue']\").prop(\"checked\",true)"]}